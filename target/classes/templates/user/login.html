<!DOCTYPE html >
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>用户登录</title>
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/main.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/basic.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/style2.css}"/>
    <link rel="stylesheet" th:href="@{/style/base.css}"/>
    <link rel="stylesheet" th:href="@{/style/head.css}"/>
    <link type="text/css" th:href="@{/css/css1.css}" rel="stylesheet" />
    <script type="text/javascript" th:src="@{/js/jquery.js}"></script>
    <script type="text/javascript" th:src="@{/js/js.js}"></script>
    <script th:src="@{/js/wb.js}" type="text/javascript" ></script>
    <script th:src="@{/layui/layui.js}" type="text/javascript"></script>
    <script type="text/javascript" th:src="@{/js/index.js}"></script>
    <script th:src="@{/script/global.js}" type="text/javascript"></script>
    <script th:src="@{/script/head.js}" type="text/javascript"></script>
</head>
<body>
<!--抬头开始-->
<div th:replace="~{user/common/common::top}"></div>
<!--抬头结束-->

<!--导航开始-->
<div th:replace="~{user/common/common::headNav}"></div>

<!--导航结束-->

<!--登录框-->
<div class="con_dlbj" style="background-image: url(/images/front/login_bg.jpg)">
    <div class="con_dlbj_main">
        <div class="denglu_bj2">
            <div class="denglu_nr2" style="background-color: white;height: auto">
                <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
                    <ul class="layui-tab-title">
                        <li class="layui-this" style="font-size: 17px">密码登录</li>
                        <li style="font-size: 17px">手机号登陆</li>
                    </ul>
                    <div class="layui-tab-content" style="height: 300px;font-size: 15px">
                        <div class="layui-tab-item layui-show">
                            <form th:action="@{/user/login}" method="post">
                                <div class="dl_yhm">
                                    用户名：<input name="username" type="text"  size="30" autocomplete="off" required onclick="if(value==defaultValue){value='';this.style.color='#3d4245'}" onBlur="if(!value){value=defaultValue;this.style.color='#ccc'}" style="width:170px; height:24px; line-height:24px; padding-left:5px;color:#ccc; border:1px solid #e4e4e4;"/>
                                </div>
                                <div class="dl_yhm">
                                    &nbsp;&nbsp;&nbsp;密码：<input name="password" type="password" required style="width:170px; height:24px;line-height:24px; padding-left:5px;color:#3d4245; border:1px solid #e4e4e4;">
                                </div>
                                <div class="dl_dl">
                                    <input type="submit" class="login" value="登 录" onmousedown="this.style.left='1px';this.style.top='1px';" onmouseup="this.style.left='0px';this.style.top='0px';" style="width:135px;height:39px; border:none; background:url(/images/front/dl_dl.jpg); color:#FFF; font-size:14px;font-family:'微软雅黑'; position:relative;">
                                    <a href="#" style="font-size: 13px">忘记密码？</a>
                                </div>
                            </form>
                            <div class="denglu_sm" >
                                <div th:if="not ${#strings.isEmpty(msg)}" th:text="${msg}" style="color: red"></div>
                                <span style="color:#529014; font-weight:600;">如果您还不是该平台的的用户?</span>
                            </div>
                            <div class="denglu_hmzc" style="margin-top: auto"><a th:href="@{/user/toRegister}">立即注册</a></div>
                        </div>
                        <div class="layui-tab-item">
                            <form action="##">
                                <div class="dl_yhm">
                                    手机号：<input name="phone" type="text" id="phone" size="30" required onclick="if(value==defaultValue){value='';this.style.color='#3d4245'}" onBlur="if(!value){value=defaultValue;this.style.color='#ccc'}" style="width:170px; height:24px; line-height:24px; padding-left:5px;color:#ccc; border:1px solid #e4e4e4;"/>
                                </div>
                                <div class="dl_yhm">
                                    验证码：<input name="yzm" id="yzm"  type="text" required style="width:77px; height:24px;line-height:24px; padding-left:5px;color:#3d4245; border:1px solid #e4e4e4;">
                                    <span style="float:right; width:95px; height:32px; display:block; margin-top:5px;"><button type="button" id="btn" onclick="send()" style="color: #fff3f3;background-color: #21b05e;border-color: #21b05e;width: 90px;height: 22px;margin-bottom: 11px"><span class="msg1">获取验证码</span></button></span>
                                </div>
                                <div class="dl_dl">
                                    <input type="button" class="login" onclick="login()" value="登 录" onmousedown="this.style.left='1px';this.style.top='1px';" onmouseup="this.style.left='0px';this.style.top='0px';" style="width:135px;height:39px; border:none; background:url(/images/front/dl_dl.jpg); color:#FFF; font-size:14px;font-family:'微软雅黑'; position:relative;">
                                </div>
                            </form>
                            <div class="denglu_sm">
                                <div class="msg" th:text="${msg}" style="color: red"></div>
                                <span style="color:#529014; font-weight:600;">如果您还不是该平台的的用户?</span><br />
                            </div>
                            <div class="denglu_hmzc"><a th:href="@{/user/toRegister}">立即注册</a></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--底部开始-->
<!--友情连接开始-->

<div class="links">
    <div class="links_main">友情连接：&nbsp;<a href="#">郑州卓普科技</a> &nbsp; | &nbsp; 本亲生活网  &nbsp;|  &nbsp;郑州卓普科技 &nbsp; | &nbsp; 本亲生活网 &nbsp; | &nbsp; 郑州卓普科技 &nbsp; | &nbsp; 本亲生活网 &nbsp; | &nbsp; 郑州卓普科技 &nbsp; |  &nbsp;本亲生活网 &nbsp; |  &nbsp;郑州卓普科技 &nbsp; | &nbsp; 本亲生活网&nbsp;  |&nbsp;  郑州卓普科技  </div>
</div>

<!--友情链接结束-->
<!--软文开始-->
<div th:insert="~{user/common/common::ruanwen}"></div>
<script>
    layui.use('element', function(){
        var $ = layui.jquery
            ,element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

        $('.site-demo-active').on('click', function(){
            var othis = $(this), type = othis.data('type');
            active[type] ? active[type].call(this, othis) : '';
        });
    });

    $('#phone').focus(function () {
        $('.msg').text("");
    })
    /*发送验证码*/
    function send() {
        /*获取电话号码*/
        var phone=$('#phone').val();
        if(phone==""){
            $('.msg').text("请输入手机号");
            return false;
        }
        function invokeSettime(obj){
            var countdown=60;
            settime(obj);
            function settime(obj) {
                if (countdown == 0) {
                    $(obj).attr("disabled",false);
                    $(obj).text("获取验证码");
                    countdown = 60;
                    return;
                } else {
                    $(obj).attr("background-color","#848b87");
                    $(obj).attr("border-color","#848b87");
                    $(obj).attr("disabled",true);

                    $(obj).text(countdown + " s 后重新发送");
                    countdown--;
                }
                setTimeout(function() {
                        settime(obj) }
                    ,1000)
            }
        }
        new invokeSettime("#btn");

        /*获取验证码*/
        $.ajax({
            url: '/sendSMS',
            type: 'post',
            data: {"phoneNumber":phone},
            success: function () {
                $('.msg1').text("已发送");
            }
        });
    }

    /*通过手机号码登陆*/
    function login() {
        var phone = $('#phone').val();
        var yzm = $('#yzm').val();
        if(phone==""){
            $('.msg').text("请输入手机号");
            return false;
        }
        if(yzm==""){
            $('.msg').text("请输入验证码");
            return false;
        }

        $.ajax({
            url:'/user/loginForPhone',
            type: 'post',
            data: {"phone":phone,"yzm":yzm},
            success: function (msg) {
                if (msg=='cg'){
                    window.location.href="/user/toIndex";
                }else{
                    $('.msg').text(msg);
                }
            }
        })

    }
</script>
</body>
</html>
